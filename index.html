<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>FitSnacks</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0d">
  <style>
    :root { --bg:#0b0b0d; --card:#141418; --text:#e9e9ec; --muted:#aaa; --accent:#6ea8fe; --badge:#ff3b30; --radius:18px; }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font:16px -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
    .app{max-width:393px;min-height:100svh;margin:0 auto;padding:12px 12px 32px;box-sizing:border-box}

    /* Header */
    .row{position:relative; display:flex; align-items:center; gap:0}
    .search-wrap{flex:none; width:calc(100% - 200px);}
    .search{width:100%;background:#1b1b20;border-radius:999px;border:1px solid #2a2a2e;padding:12px 44px;color:var(--text);outline:none}
    .search::placeholder{color:#6c6c70}
    .icon-left{position:absolute;left:12px;top:50%;transform:translateY(-50%)}
    .icon-rights{position:absolute; right:8px; top:50%; transform:translateY(-50%); display:flex; gap:10px;}
    .btn{-webkit-appearance:none;appearance:none;background:#24242a;border:1px solid #2d2d33;border-radius:14px;width:44px;height:44px;padding:0;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
    #cartBtn { position:relative; display:flex; align-items:center; justify-content:center }
    .badge{position:absolute; top:-6px; right:-8px; background:var(--badge); color:white; border-radius:999px; padding:1px 6px; font-size:12px; font-weight:700; display:none; align-items:center; justify-content:center;}

    /* Carousel */
    .carousel{position:relative;margin:14px 0 8px;overflow:hidden;border-radius:16px;height:120px;background:#101014}
    .track{display:flex;width:300%;height:100%;animation:slide 15s infinite}
    .slide{flex:0 0 100%;height:100%;background-size:cover;background-position:center}
    @keyframes slide{0%,28%{transform:translateX(0)}33%,61%{transform:translateX(-100%)}66%,94%{transform:translateX(-200%)}100%{transform:translateX(0)}}

    .chips{display:flex;gap:10px;margin:6px 0 12px;flex-wrap:wrap}
    .chip{background:#18181d;border:1px solid #2a2a30;color:#c9c9d1;padding:6px 10px;border-radius:999px;font-size:13px}

    /* Grid */
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .card{background:var(--card);border:1px solid #26262b;border-radius:var(--radius);padding:12px;position:relative;display:flex;flex-direction:column;min-height:190px}
    .thumb{height:90px;border-radius:12px;overflow:hidden;margin-bottom:8px}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .title{font-weight:700;margin:4px 0 2px;letter-spacing:0.2px}
    .price{color:#c7c7cc;font-weight:600;margin-top:auto}
    .add{position:absolute;right:12px;bottom:12px;background:var(--accent);border:none;color:#001230;border-radius:14px;width:42px;height:42px;font-size:22px;display:flex;align-items:center;justify-content:center;font-weight:800;cursor:pointer}

    /* Overlays */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:20px;z-index:9999}
    .overlay.show{display:flex}
    .sheet{width:92%;max-width:360px;background:var(--card);border:1px solid #2a2a30;border-radius:20px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.4)}
    #cartOverlay{align-items:flex-end}
    #cartOverlay .sheet{width:100%;max-width:480px;border-top-left-radius:24px;border-top-right-radius:24px;border-bottom-left-radius:0;border-bottom-right-radius:0;margin:0 auto;padding-bottom:calc(16px + env(safe-area-inset-bottom));transform:translateY(100%);animation:slideUp 220ms ease-out forwards;}
    @keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
  </style>
</head>
<body>
  <div class="app" role="application">
    <div class="row">
      <div class="search-wrap">
        <span class="icon-left" aria-hidden="true">üîç</span>
        <input id="search" class="search" placeholder="Search snacks‚Ä¶" autocomplete="off">
      </div>
      <div class="icon-rights">
        <button type="button" class="btn" id="cartBtn" aria-label="Open cart">
          üõí <span id="cartBadge" class="badge">0</span>
        </button>
        <button type="button" class="btn" id="settingsBtn" aria-label="Open settings">‚öôÔ∏è</button>
      </div>
    </div>

    <div class="carousel">
      <div class="track">
        <div class="slide" style="background-image:url(assets/carousel-1.jpg)"></div>
        <div class="slide" style="background-image:url(assets/carousel-2.jpg)"></div>
        <div class="slide" style="background-image:url(assets/carousel-3.jpg)"></div>
      </div>
    </div>

    <div class="chips"><div class="chip">vegan</div><div class="chip">gluten-free</div><div class="chip">protein</div></div>

    <!-- ‚úÖ Updated grid with more product cards -->
    <div id="grid" class="grid" role="list">
      <div class="card" role="listitem" data-name="Potato Chips" data-price="2.50">
        <div class="thumb"><img src="assets/product-funyuns.jpg" alt="Potato Chips"></div>
        <div class="title">Potato Chips</div>
        <div class="price">$2.50</div>
        <button class="add" aria-label="Add Potato Chips">+</button>
      </div>

      <div class="card" role="listitem" data-name="Protein Bar" data-price="2.99">
        <div class="thumb"><img src="assets/product-chesters.jpg" alt="Protein Bar"></div>
        <div class="title">Protein Bar</div>
        <div class="price">$2.99</div>
        <button class="add" aria-label="Add Protein Bar">+</button>
      </div>

      <div class="card" role="listitem" data-name="Trail Mix" data-price="3.49">
        <div class="thumb"><img src="assets/product-cheetos.jpg" alt="Trail Mix"></div>
        <div class="title">Trail Mix</div>
        <div class="price">$3.49</div>
        <button class="add" aria-label="Add Trail Mix">+</button>
      </div>

      <!-- New products -->
      <div class="card" role="listitem" data-name="Granola Bar" data-price="1.99">
        <div class="thumb"><img src="assets/product-granola.jpg" alt="Granola Bar"></div>
        <div class="title">Granola Bar</div>
        <div class="price">$1.99</div>
        <button class="add" aria-label="Add Granola Bar">+</button>
      </div>

      <div class="card" role="listitem" data-name="Fruit Snacks" data-price="1.49">
        <div class="thumb"><img src="assets/product-fruitsnacks.jpg" alt="Fruit Snacks"></div>
        <div class="title">Fruit Snacks</div>
        <div class="price">$1.49</div>
        <button class="add" aria-label="Add Fruit Snacks">+</button>
      </div>

      <div class="card" role="listitem" data-name="Energy Drink" data-price="2.25">
        <div class="thumb"><img src="assets/product-energy.jpg" alt="Energy Drink"></div>
        <div class="title">Energy Drink</div>
        <div class="price">$2.25</div>
        <button class="add" aria-label="Add Energy Drink">+</button>
      </div>

      <div class="card" role="listitem" data-name="Chocolate Bar" data-price="1.75">
        <div class="thumb"><img src="assets/product-chocolate.jpg" alt="Chocolate Bar"></div>
        <div class="title">Chocolate Bar</div>
        <div class="price">$1.75</div>
        <button class="add" aria-label="Add Chocolate Bar">+</button>
      </div>

      <div class="card" role="listitem" data-name="Trail Bar" data-price="2.15">
        <div class="thumb"><img src="assets/product-trailbar.jpg" alt="Trail Bar"></div>
        <div class="title">Trail Bar</div>
        <div class="price">$2.15</div>
        <button class="add" aria-label="Add Trail Bar">+</button>
      </div>
    </div>
  </div>

  <!-- Cart overlay -->
  <div id="cartOverlay" class="overlay">
    <div class="sheet">
      <div class="row-between"><h3>Cart</h3><div class="ghost" id="cartClose">Back</div></div>
      <div id="cartContent"></div>
      <div class="row-between" style="margin-top:10px;"><strong>Total</strong><strong id="cartTotal">$0.00</strong></div>
      <div class="actions"><button class="primary" id="cartCheckout">Checkout</button></div>
    </div>
  </div>

  <script>
    /* Cart logic (already working from before) */
    const CART_KEY = 'fitsnacks.cart.v1';
    const fmt = n => '$' + n.toFixed(2);

    function loadCart(){ try{ return new Map(JSON.parse(localStorage.getItem(CART_KEY) || '[]')); }catch(e){ return new Map(); } }
    function saveCart(map){ localStorage.setItem(CART_KEY, JSON.stringify(Array.from(map.entries()))); }

    let cart = loadCart();

    function refreshBadge(){
      let n=0; for(const v of cart.values()) n+=v.qty;
      const badge=document.querySelector('#cartBadge');
      if(n>0){ badge.textContent=n; badge.style.display='inline-flex'; } else { badge.style.display='none'; }
    }

    function renderCart(){
      let total=0, html='';
      for(const [name,info] of cart){
        const line=info.price*info.qty; total+=line;
        html+=`<div class="row-between" style="margin-top:6px">
          <div style="display:flex;gap:10px;align-items:center">
            <button data-act="-" data-name="${name}" class="ghost">‚àí</button>
            <div>${info.qty}</div>
            <button data-act="+" data-name="${name}" class="ghost">+</button>
            <div style="font-weight:700;margin-left:8px">${name}</div>
          </div>
          <div style="font-weight:700">${fmt(line)}</div>
        </div>`;
      }
      document.querySelector('#cartContent').innerHTML = html || '<div style="color:#aaa;margin-top:8px;">Cart is empty</div>';
      document.querySelector('#cartTotal').textContent=fmt(total);
      saveCart(cart); refreshBadge();
    }

    document.addEventListener('click',(e)=>{
      const b=e.target.closest('button'); if(!b) return;
      if(b.dataset.act&&b.dataset.name){
        const entry=cart.get(b.dataset.name); if(!entry) return;
        if(b.dataset.act==='+') entry.qty++; else if(b.dataset.act==='-') entry.qty=Math.max(1,entry.qty-1);
        renderCart();
      }
      if(b.id==='cartBtn'){ renderCart(); document.querySelector('#cartOverlay').classList.add('show'); }
      if(b.id==='cartClose'){ document.querySelector('#cartOverlay').classList.remove('show'); }
    });

    document.querySelectorAll('.add').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const card=e.target.closest('.card');
        const name=card.dataset.name, price=parseFloat(card.dataset.price);
        const existing=cart.get(name)||{price,qty:0};
        existing.qty+=1; cart.set(name,existing);
        renderCart(); document.querySelector('#cartOverlay').classList.add('show');
      });
    });

    renderCart();
  </script>
</body>
</html>