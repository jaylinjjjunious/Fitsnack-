<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>FitSnacks</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0d">
  <style>
    :root { --bg:#0b0b0d; --card:#141418; --text:#e9e9ec; --muted:#aaa; --accent:#6ea8fe; --badge:#ff3b30; --radius:18px; }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font:16px -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
    .app{max-width:393px;min-height:100svh;margin:0 auto;padding:12px 12px 32px;box-sizing:border-box}

    /* Header */
    .row{position:relative; display:flex; align-items:center; gap:0}
    .search-wrap{flex:none; width:calc(100% - 200px);}
    .search{width:100%;background:#1b1b20;border-radius:999px;border:1px solid #2a2a2e;padding:12px 44px;color:var(--text);outline:none}
    .search::placeholder{color:#6c6c70}
    .icon-left{position:absolute;left:12px;top:50%;transform:translateY(-50%)}
    .icon-rights{position:absolute; right:8px; top:50%; transform:translateY(-50%); display:flex; gap:10px; margin-left:0}
    .btn{-webkit-appearance:none;appearance:none;background:#24242a;border:1px solid #2d2d33;border-radius:14px;width:44px;height:44px;padding:0;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
    #cartBtn{position:relative;display:flex;align-items:center;justify-content:center}
    .badge{position:absolute;top:-6px;right:-8px;background:var(--badge);color:white;border-radius:999px;padding:1px 6px;font-size:12px;font-weight:700;display:inline-flex;align-items:center;justify-content:center}

    /* Overlay base */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:20px;z-index:9999}
    .overlay.show{display:flex}
    .sheet{width:92%;max-width:360px;background:var(--card);border:1px solid #2a2a30;border-radius:20px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.4)}

    /* Cart + Checkout slide-up */
    #cartOverlay{align-items:flex-end}
    #checkoutOverlay{align-items:flex-end}
    #cartOverlay .sheet,
    #checkoutOverlay .sheet{
      width:100%;
      max-width:480px;
      border-top-left-radius:24px;border-top-right-radius:24px;
      border-bottom-left-radius:0;border-bottom-right-radius:0;
      margin:0 auto;
      padding-bottom:calc(16px + env(safe-area-inset-bottom));
      transform:translateY(100%);
      animation:slideUp 220ms ease-out forwards;
    }
    @keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}

    .row-between{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .ghost{background:#1b1b20;border:1px solid #2a2a30;color:#e7e7eb;border-radius:12px;padding:10px 12px;cursor:pointer}
    .primary{background:var(--accent);border:0;color:#081425;font-weight:800;border-radius:12px;padding:12px 14px;cursor:pointer}
  </style>
</head>
<body>
  <div class="app">
    <div class="row">
      <div class="search-wrap">
        <span class="icon-left">üîç</span>
        <input id="search" class="search" placeholder="Search snacks‚Ä¶" autocomplete="off">
      </div>
      <div class="icon-rights">
        <button type="button" class="btn" id="cartBtn">üõí<span id="cartBadge" class="badge" style="display:none;">0</span></button>
        <button type="button" class="btn" id="settingsBtn">‚öôÔ∏è</button>
      </div>
    </div>

    <!-- Example Product Grid -->
    <div id="grid" class="grid">
      <div class="card" data-name="Potato Chips" data-price="2.50">
        <div class="title">Potato Chips</div>
        <div class="price">$2.50</div>
        <button class="add">+</button>
      </div>
    </div>
  </div>

  <!-- Cart Overlay -->
  <div id="cartOverlay" class="overlay">
    <div class="sheet">
      <div class="row-between">
        <h3>Cart</h3>
        <button class="ghost" id="cartClose" type="button">Back</button>
      </div>
      <div id="cartContent"></div>
      <div class="row-between" style="margin-top:10px;">
        <strong>Total</strong><strong id="cartTotal">$0.00</strong>
      </div>
      <div class="actions"><button class="primary" id="cartCheckout">Checkout</button></div>
    </div>
  </div>

  <!-- Checkout Overlay -->
  <div id="checkoutOverlay" class="overlay">
    <div class="sheet">
      <div class="row-between">
        <h3>Checkout</h3>
        <button class="ghost" id="checkoutClose" type="button">Back</button>
      </div>
      <div style="margin-top:6px;">Your name:</div>
      <input id="checkoutName" style="width:100%;padding:10px;border-radius:10px;background:#101014;color:#e9e9ec;margin-top:6px">
      <div style="margin-top:10px;">Where are you on campus?</div>
      <input id="checkoutLocation" style="width:100%;padding:10px;border-radius:10px;background:#101014;color:#e9e9ec;margin-top:6px">
      <div id="checkoutError" style="display:none;color:#ff6b6b;margin-top:10px;">Please fill both fields.</div>
      <div class="actions" style="margin-top:12px;">
        <button class="primary" id="checkoutSubmit">Place Order</button>
      </div>
    </div>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    const cart = new Map();
    const fmt = n => '$' + n.toFixed(2);

    function refreshBadge(){
      let n=0; for(const v of cart.values()) n+=v.qty;
      const badge = $('#cartBadge');
      if(n>0){ badge.textContent=n; badge.style.display='inline-flex'; }
      else { badge.style.display='none'; }
    }
    function renderCart(){
      let total=0, html='';
      for(const [name,info] of cart){
        const line=info.price*info.qty; total+=line;
        html += `<div>${info.qty} √ó ${name} -- ${fmt(line)}</div>`;
      }
      $('#cartContent').innerHTML = html || '<div style="color:#aaa;">Cart is empty</div>';
      $('#cartTotal').textContent = fmt(total);
      refreshBadge();
    }

    // Add items
    $$('.add').forEach(b=>{
      b.addEventListener('click', e=>{
        const card = e.target.closest('.card');
        const name = card.dataset.name;
        const price = parseFloat(card.dataset.price);
        const item = cart.get(name) || {price, qty:0};
        item.qty++;
        cart.set(name, item);
        renderCart();
        $('#cartOverlay').classList.add('show');
      });
    });

    // Overlay toggles
    $('#cartBtn').addEventListener('click', ()=>$('#cartOverlay').classList.add('show'));
    $('#cartClose').addEventListener('click', ()=>$('#cartOverlay').classList.remove('show'));

    $('#cartCheckout').addEventListener('click', ()=>{
      $('#checkoutOverlay').classList.add('show');
      $('#cartOverlay').classList.remove('show');
    });
    $('#checkoutClose').addEventListener('click', ()=>$('#checkoutOverlay').classList.remove('show'));
  </script>
</body>
</html>